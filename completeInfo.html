<!DOCTYPE html>

<html>
<head>
    <meta name="keywords" content="@ViewBag.KeyWord">
    <meta charset="utf-8">
    <meta name="language" content="fa">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<!--    <link href="Content/bootstrap.min.css" rel="stylesheet" />-->
    <link href="Content/css/bootstrap-rtl.css" rel="stylesheet" />
    <link href="Content/css/w3.css" rel="stylesheet" />
    <link href="ParsaFont/Style.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="Scripts/jquery-3.2.1.min.js"></script>
    <script src="Scripts/ckeditor/ckeditor.js"></script>
    <script src="Scripts/bootstrap-rtl.js"></script>
    <script src="Scripts/jquery.validate.min.js"></script>
    <script src="Scripts/jquery.validate.unobtrusive.min.js"></script>
    <meta name="viewport" content="width=device-width" />

    <title>@ViewBag.Title</title>

</head>
<body style="background-color:#E5E5E5">
    <style>
        .componentColor {
            background-color: #F2F2F2 !important;
        }

        .btnColors {
            background-color: #006DA0 !important;
            color: #ECEDEF !important;
            width: auto;
            height: 30px
        }

        /*.btnHoverColor:hover {
            background-color: #d3df13 !important;
            color: #212121 !important;
        }*/
        .navigationBarColor {
            background-color: #21262A !important;
            color: #7B8084;
        }

        .rightMenuColor {
            background-color: #2F3438 !important;
            color: #EFF0F4;
        }

            .rightMenuColor:hover {
                background-color: #181B20 !important;
                color: #02B2E1;
            }

        .dropbtn {
            padding: 16px;
            font-size: 16px;
            border: none;
            cursor: pointer;
        }
        input[type=text] {
            padding: 12px 20px;
            display: inline-block;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        input {
            font-size: 18px;
            padding: 10px 10px 10px 5px;
            display: block;
            width: 300px;
            border: 1px solid #212121;
            background: transparent !important;
            color: #212121;
            /*border-radius: 10px;*/
        }
        label {
            color: #7B8084 !important;
            font-weight: normal !important;
            position: absolute;
            pointer-events: none;
            right: 45px;
            top: 20px;
        }

        .pictureInput {
            top: -1px;
            font-size: 12px;
            padding-left: 3px;
            padding-right: 3px;
            padding-bottom: 2px;
            color: #7B8084 !important;
            background: #F2F2F2 !important;
            background-size: 50px 30px;
        }
        input:focus ~ label,
        input:valid ~ label {
            top: -1px;
            font-size: 12px;
            padding-left:3px;
            padding-right:3px;
            color: #7B8084 !important;
            background: #F2F2F2 !important;
            background-size: 50px 30px;
        }

        input:focus,
        input:valid {
            border-color: #006DA0 !important;
        }

    </style>
<!--    nav bar in signUp should not be appear-->
<!--    <nav class="w3-sidenav w3-card-16 w3-animate-right " style="display:block;background-color:#2F3438" id="rightMenu">-->
<!--        <div class="w3-margin ">-->
<!--            <div class="w3-center " style="margin-top:8px !important">-->
<!--                <img class="w3-center w3-closenav w3-xlarge " src="avatar/man-with-tie.png" style="width:100px ; height:100px" />-->
<!--            </div>-->
<!--            <br />-->
<!--            <a href="editProfile.html" class="rightMenuColor w3-center"> &nbsp;نام کاربر</a>-->
<!--            <br />-->
<!--            <a class="rightMenuColor" onclick="myFunction('Demo1')">-->
<!--                <span class="glyphicon glyphicon-home" style="color:#7B8084"></span>&nbsp;&nbsp;فروشگاه های من-->
<!--                &nbsp;<span class="glyphicon glyphicon-chevron-down " id="more" style="color:#7B8084;margin-top:2px"></span>-->
<!--            </a>-->
<!--            <div id="Demo1" class="w3-container w3-hide ">-->
<!--                <a href="showShop.html" class="rightMenuColor"> &nbsp;فروشگاه اول</a>-->
<!--                <a href="showShop.html" class="rightMenuColor">&nbsp; فروشگاه دوم</a>-->
<!--                <a href="showShop.html" class="rightMenuColor"> &nbsp;فروشگاه سوم </a>-->
<!--                <a href="addShop.html" class="w3-center rightMenuColor">-->
<!--                    <span class="glyphicon glyphicon-plus"></span> &nbsp;جدید&nbsp;-->
<!--                </a>-->
<!--            </div>-->
<!--            <br />-->
<!--            <div class="rightMenuColor">-->
<!--                <a href="showPoll.html" class="rightMenuColor"><span class="glyphicon glyphicon-signal" style="color:#7B8084"></span>&nbsp;&nbsp; نظرسنجی های من </a>-->
<!--            </div><br />-->
<!--            <div class="rightMenuColor">-->
<!--                <a href="ShowDiscount.html" class="rightMenuColor"><span class="glyphicon glyphicon-usd" style="color:#7B8084"></span>&nbsp;&nbsp; تخفیف های من </a>-->
<!--            </div><br />-->
<!--            <div class="rightMenuColor">-->
<!--                <a href="advertisementPage.html" class="rightMenuColor"><span class="glyphicon glyphicon-earphone" style="color:#7B8084"></span>&nbsp;&nbsp; تبلیغات </a>-->
<!--            </div><br />-->
<!--            <div class="rightMenuColor">-->
<!--                <a href="support.html" class="rightMenuColor"><span class="glyphicon glyphicon-earphone" style="color:#7B8084"></span>&nbsp;&nbsp; پشنیبانی </a>-->
<!--            </div><br />-->
<!--            <div class="rightMenuColor">-->
<!--                <a href="HomePage.html" class="rightMenuColor"><span class="glyphicon glyphicon-off" style="color:#7B8084"></span>&nbsp;&nbsp; خروج از پنل </a>-->
<!--            </div><br />-->
<!--        </div>-->
<!--    </nav>-->

    <header class="w3-container navigationBarColor ">
<!--        <span class="w3-opennav w3-xlarge w3-right" id="rightMenu_open_btn">&#9776;</span>-->
        <div class="text-center">
            <h1> <span class="w3-margin-right ;navbar-brand  w3-xxlarge w3-text " style="font-family: 'Baloo Bhai', cursive; color:#7B8084!important" href="HomePage.html">DisPoll</span></h1>
        </div>
    </header>
    <br />
    <div class="container">
        <div class=" w3-xlarge w3-center" style="color:#7B8084; margin-bottom:20px">
           فرم تکمیل اطلاعات کاربری
        </div>
        <div class="col-lg-offset-2">
            <div class="w3-border w3-border-light-gray w3-card-12 w3-padding componentColor">
                <form class="form-horizontal" id="signUp-complete-info-form">

                    <div class="form-group">
                        <div class="col-md-11">
                            <input type="email" name="email" value=""
                                   class="form-control w3-margin"
                                   id="signUp-complete-info-form-email-inp"
                                   accept="application/txt" disabled />
<!--                            <label> ایمیل</label>-->
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-11">
                             <input type="username" required name="username" value=""
                                                class="form-control w3-margin"
                                                id="signUp-complete-info-form-username-inp"
                                                accept="application/txt" />
                             <label>نام کاربری</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-11">
                            <input type="text" required name="firstName" value=""
                                   class="form-control w3-margin"
                                   id="signUp-complete-info-form-first-name-inp"
                                   accept="application/txt" />
                            <label>نام </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-11">
                            <input type="text" required name="lastName" value=""
                                   class="form-control w3-margin"
                                   id="signUp-complete-info-form-last-name-inp"
                                   accept="application/txt" />
                            <label>نام خانوادگی </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-11">
                            <select class="form-control w3-margin w3-trasparent" name="gender"
                                    id="signUp-complete-info-form-gender-inp"
                                    style="height:40px;background-color:#F2F2F2 !important" >
                                <option class="placeholder" selected disabled hidden value="" >جنسیت</option>
                                <!--distance in another way-->
                                <option value="" disabled ></option>
                                <option value="f">زن</option>
                                <option value="m">مرد</option>
                                <option value="" disabled ></option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-11">
                             <input type="tel" required name="phoneNumber" value=""
                                                class="form-control w3-margin"
                                                id="signUp-complete-info-form-phone-number-inp"
                                                accept="application/txt" />
                            <label> شماره تلفن</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-11">
                            <input type="text" name="address" value=""
                                            class="form-control w3-margin"
                                            id="signUp-complete-info-form-address-inp"
                                            accept="application/txt" />
                            <label> آدرس</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-11">
                            <select class="form-control w3-margin w3-trasparent" name="city"
                                    id="signUp-complete-info-form-city-inp"
                                    style="height:40px ; background-color:#F2F2F2">
                                <option class="placeholder" selected disabled hidden value="" >شهر</option>
                                <option value="" disabled ></option>
                                <!--need a for to read city names from db-->
                                <option value="" id="signUp-complete-info-form-city-lastOp-op" disabled ></option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-11" style="color:#7B8084 !important">
                             <input type="file" name="Image" value=""
                                                id="signUp-complete-info-form-image-inp"
                                                class="form-control w3-margin" accept="image/*" />
                             <label class="pictureInput">تصویر آواتار</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-offset-5 col-md-11">
                            <input type="submit" value="ذخیره"
                                   class="btn btn-default btnColors" disabled="disabled"
                                   id="signUp-complete-info-form-submit-btn" />
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <br /><br /><br />
    <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
    <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />

    <footer class="text-center w3-text-white w3-padding" style="background-color:#232935 !important">
        تمامی حقوق مادی و معنوی این سایت متعلق به DisPoll است
        <br />
        طراحی و پیاده سازی توسط Group G
    </footer>

    <script>
        function myFunction(id) {
            var x = document.getElementById(id);
            const y =document.getElementById("more");
            y.style.transform = "rotate(180deg)";
            if (x.className.indexOf("w3-show") == -1) {
                x.className += " w3-show";
            } else {
                x.className = x.className.replace(" w3-show", "");
                y.style.transform = "rotate(0deg)";
            }
        }

        // window.closed = function() {
        //     localStorage.clear();
        // };
    </script>

    <script>

        $(document).ready( function () {

            const signUp_complete_info_form_var = document.getElementById("signUp-complete-info-form");
            signUp_complete_info_form_var.email.value=window.sessionStorage.email;
            // $("#signUp-complete-info-form-email-inp").attr("value", window.sessionStorage.email);


            /*
            Function to disable button if form is not valid
             */
            var $requiredInputs = $("#signUp-complete-info-form").find("input:required");
            $requiredInputs.keyup(function () {
               var empty_test = false;
               $requiredInputs.each(function () {
                  if($(this).val()==='')
                      empty_test = true;
               });

               if(empty_test === true)
                   $("#signUp-complete-info-form-submit-btn").attr("disabled", "disabled");
               else {
                   $("#signUp-complete-info-form-submit-btn").removeAttr("disabled");
               }
            });

            /*
            Request for getting cities name and id from server
            */
            $.get("address.txt", function (data) {
                const my_address = data + "/cities/";
                $.ajax({
                    type: 'GET',
                    // dataType: 'json',
                    // contentType: 'application/json',
                    url: my_address,
                    // data: signUp_complete_info_json,
                    success: function(resultData, status, xhr){
                        alert(resultData.message);
                        if (resultData.result.toString() === "true") {
                            for (let val of (resultData.cities)) {
                                const op = document.createElement("option");
                                const opText = document.createTextNode(val.name);
                                const lastOp = document.getElementById("signUp-complete-info-form-city-lastOp-op");
                                op.value = val.id;
                                op.appendChild(opText);
                                signUp_complete_info_form_var.city.insertBefore(op,lastOp);
                            }
                        }
                    },
                    error: function () {
                        alert(" اتصال به اینترنت برقرار نیست. ");}
                })
            });


            $("#signUp-complete-info-form").submit(function (e) {
                e.preventDefault();



                const  username_var = signUp_complete_info_form_var.username.value;
                const  firstName_var = signUp_complete_info_form_var.firstName.value;
                const  lastName_var = signUp_complete_info_form_var.lastName.value;
                const  phoneNumber_var = signUp_complete_info_form_var.phoneNumber.value;
                const  address_var = signUp_complete_info_form_var.address.value;
                const  city_var = signUp_complete_info_form_var.city.value;
                const  gender_var = signUp_complete_info_form_var.gender.value;


                // if (username_var.length >= 5 ) {


                var avatar =$("#signUp-complete-info-form-image-inp").get(0).files[0];

                var signUp_formData = new FormData();

                signUp_formData.append("email", window.sessionStorage.email);
                signUp_formData.append("password", window.sessionStorage.password);
                signUp_formData.append("username", username_var);
                signUp_formData.append("first_name", firstName_var);
                signUp_formData.append("last_name", lastName_var);
                signUp_formData.append("phone_number", phoneNumber_var);
                signUp_formData.append("city", city_var);
                signUp_formData.append("address", address_var);
                signUp_formData.append("gender", gender_var);
                signUp_formData.append("avatar", avatar);



                    $.get("address.txt", function (data) {
                        const my_address = data + "/salesman/signup/complete-info/";
                        $.ajax({
                            type: 'POST',
                            dataType: 'json',
                            url: my_address,
                            data: signUp_formData,
                            contentType: false,
                            processData: false,
                            crossDomain: true,
                            success: function(resultData, status, xhr){
                                alert(resultData.message);
                                if (resultData.result.toString() === "true") {
                                    window.location.href="HomePage.html";
                                }
                            },
                            error: function () {
                                alert(" اتصال به اینترنت برقرار نیست. ");}
                        })

                    });
                // } else
                //     alert("طول نام کاربری و رمزعبور باید حداقل 5 کاراکتر باشد.");
            });

        });


    </script>

</body>
</html>