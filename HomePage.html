<!DOCTYPE html>

<html>
<head>
    <meta name="keywords" content="@ViewBag.KeyWord">
    <meta charset="utf-8">
    <meta name="language" content="fa">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<!--    <link href="Content/bootstrap.min.css" rel="stylesheet"/>-->
    <link href="Content/css/bootstrap-rtl.css" rel="stylesheet"/>
    <link href="Content/css/w3.css" rel="stylesheet"/>
    <link href="ParsaFont/Style.css" rel="stylesheet"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="Scripts/jquery-3.2.1.min.js"></script>
    <script src="Scripts/ckeditor/ckeditor.js"></script>
    <script src="Scripts/bootstrap-rtl.js"></script>
    <script src="Scripts/jquery.validate.min.js"></script>
    <script src="Scripts/jquery.validate.unobtrusive.min.js"></script>
    <meta name="viewport" content="width=device-width"/>
    <title>@ViewBag.Title</title>


</head>
<body style="background-color:#E5E5E5 !important">
<style>
    .fa-refresh {
        margin: 4px 0 0px 5px;
        padding: 5px;
        height: 75px;
        width: 75px;
        font-size: 18px;
        color: rgba(0, 0, 0, 0.2);
        cursor: pointer;
        -webkit-transform-origin: center center;
        transform-origin: center center;
        transition: color 0.2s ease-out, -webkit-transform 0.2s ease-out;
        transition: transform 0.2s ease-out, color 0.2s ease-out;
        transition: transform 0.2s ease-out, color 0.2s ease-out, -webkit-transform 0.2s ease-out;
    }

    .fa-refresh:hover {
        color: rgba(0, 0, 0, 0);
        -webkit-transform: rotate(180deg);
        transform: rotate(180deg);
    }

    .componentColor {
        background-color: #F2F2F2 !important;
    }

    .btnColors {
        background-color: #006DA0 !important;
        color: #ECEDEF !important;
        width: 70px;
        height: 30px
    }

    /*.btnHoverColor:hover {
        background-color: #d3df13 !important;
        color: #212121 !important;
    }*/
    .navigationBarColor {
        background-color: #21262A !important;
        color: #7B8084;
    }

    .rightMenuColor {
        background-color: #2F3438 !important;
        color: #EFF0F4;
    }

    .rightMenuColor:hover {
        background-color: #181B20 !important;
        color: #02B2E1;
    }

    .col-container {
        display: table;
        width: 100%;
    }

    .col {
        display: table-cell;
        padding: 16px;
    }

    .tab {
        width: 100%;
        overflow: hidden;
        background-color: #f1f1f1;
    }

    /* Style the buttons inside the tab */
    .tab button {
        background-color: inherit;
        float: right;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
    }

    /* Change background color of buttons on hover */
    .tab button:hover {
        background-color: #ddd;
    }

    .signupActive {
        background-color: #ccc !important;
    }

    /* Create an active/current tablink class */
    .tab button.active {
        background-color: #ccc;
    }

    /* Style the tab content */
    .tabcontent {
        display: none;
    }
    input[type=text] {
        padding: 12px 20px;
        display: inline-block;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    input {
        font-size: 18px;
        padding: 10px 10px 10px 5px;
        display: block;
        width: 300px;
        border: 1px solid #212121;
        background: transparent !important;
        color: #212121;
        /*border-radius: 10px;*/
    }

    label {
        color: #7B8084 !important;
        font-weight: normal !important;
        position: absolute;
        pointer-events: none;
        right: 45px;
        top: 20px;
    }

    input:focus ~ label,
    input:valid ~ label {
        top: -1px;
        font-size: 12px;
        padding-left: 3px;
        padding-right: 3px;
        padding-bottom: 3px;
        color: #7B8084 !important;
        background: #F2F2F2 !important;
        background-size: 50px 30px;
    }

    input:focus,
    input:valid {
        border-color: #006DA0 !important;
    }
</style>
<br/><br/>
<div class="container" style="background-color:none !important">
    <div class="col-container">
        <div class="col componentColor">
            <br/>
            <br/>
            <h1><span class="w3-margin-right ;navbar-brand  w3-xxlarge w3-text "
                      style="font-family: 'Baloo Bhai', cursive; color:#7B8084!important"
                      href="HomePage.html">DisPoll</span></h1>
            <br/>
            <br/>
            توضیحات سایت ما
            <br/>
            <br/>
            <br/>
            <!-- <img  style="width:300px;height:200px" src="avatar/shop.jpg"  />-->
        </div>
        <div class="col componentColor ">
            <div class="col-lg-offset-2">
                <div class="componentColor">
                    <div class="tab btn-group">
                        <button style="width:50% " class="tablinks signupActive" onclick="openDIV(event, 'signUp_email_auth')">ثبت
                            نام
                        </button>
                        <button style="width:50%" class="tablinks" onclick="openDIV(event, 'login')">ورود</button>
                    </div>
                </div>
            </div>
            <div id="signUp_email_auth" style="display:block!important" class="tabcontent">
                <div onload="createCaptcha()">
                    <div class="col-lg-offset-2">
                        <div class="w3-border w3-border-light-gray w3-card-12 w3-padding componentColor">
                            <form id="signUp_email_auth_form" class="form-horizontal" onsubmit="validateCaptcha()">

                                <br/>
                                <div class="form-group">
                                    <div class="col-md-10">
                                        <input type="email" required name="email" value=""
                                               class="form-control w3-margin w3-transparent"
                                               id="signUp_email_auth_form_email_inp"
                                               accept="application/txt"/>
                                        <label>پست الکترونیکی</label>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="col-md-10">
                                        <input type="password" required name="password" value=""
                                               class="form-control w3-margin w3-transparent"
                                               id="signUp_email_auth_form_password_inp"
                                               accept="application/txt"/>
                                        <label>کلمه عبور</label>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <input id="cb" type="checkbox" style="float: right;margin-left:13px !important; margin-top:20px !important; margin-right:13px !important; width:15px;height:15px" >
                                    <div style="margin-left:8px;" class="w3-margin">
                                        شرایط و قوانین استفاده را می پذیرم.
                                    </div>
                                    <!--<div class="col-md-10 w3-margin" style="display: table; width: 100%">
        <span style=" display: table-cell;">
            <input type="checkbox" required name="checkbox" value=""
                   class="form-control w3-margin"
                   id="signUp_email_auth_form_checkbox_inp"
                   accept="application/txt"
                   style="width : 25px ; height:25px ;" />
            شرایط و قوانین استفاده را می پذیرم.
        </span>

    </div>-->
                                </div>
                                <div class="w3-margin">تصویر امنیتی زیر را وارد کنید و به خاطر داشته باشید که کد به حروف بزرگ و کوچک حساس است.</div>
                                <div class="w3-center">
                                    
                                    <div class="form-group w3-center">
                                        <div class="col-md-10 w3-margin">
                                            <div class="captcha" id="signUp_email_auth_form_captcha_img"></div>
                                            <br />
                                            <div style="display: table;width: 100%;margin-left:5px !important">
                                                <div style="display:table-cell">
                                                    <input type="text" required placeholder="Captcha"
                                                           id="signUp_email_auth_form_captcha_inp"
                                                           accept="application/txt" style="width:300px ; height:40px" />
                                                </div>
                                                <div  style="display:table-cell">
                                                    <img src="icon/8338-200.png" class="fa-refresh" style="width:30px; height:30px;margin-right:5px !important" onclick="createCaptcha()">
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                    <div class="form-group ">
                                        <div class="col-md-offset-5 col-md-11">
                                            <input type="submit" value="ثبت نام"
                                                   class="btn btn-default btnColors"
                                                   id="signUp_email_auth_form_submit_btn" />
                                        </div>
                                    </div>
                                
                            </form>
                        </div>
                    </div>

                </div>
            </div>
            <div id="login" class="tabcontent">
                <div class="col-lg-offset-2">
                    <div class="w3-border w3-border-light-gray w3-card-12 w3-padding componentColor">
                        <form id="login_form" class="form-horizontal">

                            <div class="form-group">
                                <div class="col-md-10">
                                     <input type="text" required autofocus name="username" value=""
                                                        class="form-control w3-margin"
                                                        id="login_form_username_inp"
                                                        accept="application/txt" />
                                    <label> نام کاربری </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="col-md-10">
                                    <input type="password" required autofocus name="password" value=""
                                                       class="form-control w3-margin"
                                                       id="login_form_password_inp"
                                                       accept="application/txt" />
                                    <label> کلمه عبور </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="col-md-offset-5 col-md-10">
                                    <input type="submit" value="ورود " class="btn btn-default btnColors" id="login_form_submit_btn" />
                                </div>
                            </div>

                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>


<br/>
<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
<!--Modal container-->
<div class="modal fade" role="dialog" id="signUp_confirm_email_model">
    <div class="modal-dialog ">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">کد ارسالی</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6 ">
                        <img class="w3-" style="width:300px ; height:300px" src="icon/app_icon.png"/>
                        <br/>
                    </div>
                    <br/>
                    <div class="col-md-6 w3-center">
                        <br/><br/>
                        <div class="form-group col-md-offset-2">
                            <div class="col-md-10">
                                کد دریافتی:<input type="text" required autofocus name="code" value=""
                                                  class="form-control w3-margin"
                                                  id="signUp_confirm_email_model_inp"
                                                  accept="application/txt"/>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-offset-2 col-md-10 w3-padding">
                                <input data-toggle="modal" data-target="#1" type="submit" value="ثبت کد"
                                       class="btn btn-default btnColors"
                                       id="signUp_confirm_email_model_btn"/>
                            </div>
                        </div>
                        <br/><br/>
                        <div class="form-group w3-center">
                            <div class="col-md-offset-2 col-md-10 w3-padding">
                                <a style="text-decoration:none ; color:#d3df13" id="signUp_resend_code"> ارسال مجدد کد </a>
                            </div>
                        </div>
                    </div>
                    <br/>
                    <br/>
                    <br/>
                    <br/>
                </div>
            </div>

        </div>
    </div>
</div>

<script>
    function openDIV(evt, divName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(divName).style.display = "block";
        evt.currentTarget.className += " active";
    }
</script>
<script>


    var code;

    function createCaptcha() {
        //clear the contents of captcha div first
        document.getElementById("signUp_email_auth_form_captcha_img").innerHTML = "";
        var charsArray =
            "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
        var lengthOtp = 6;
        var captcha = [];
        for (var i = 0; i < lengthOtp; i++) {
            //below code will not allow Repetition of Characters
            var index = Math.floor(Math.random() * charsArray.length + 1); //get the next character from the array
            if (captcha.indexOf(charsArray[index]) === -1)
                captcha.push(charsArray[index]);
            else i--;
        }
        var canv = document.createElement("canvas");
        canv.id = "captcha";
        canv.width = 100;
        canv.height = 50;
        var ctx = canv.getContext("2d");
        ctx.font = "25px Georgia";
        // ctx.color = #d3df1;
        ctx.strokeText(captcha.join(""), 0, 30);
        //storing captcha so that can validate you can save it somewhere else according to your specific requirements
        code = captcha.join("");
        document.getElementById("signUp_email_auth_form_captcha_img").appendChild(canv); // adds the canvas to the body element
    }

    function validateCaptcha() {
        event.preventDefault();
        if (document.getElementById("signUp_email_auth_form_captcha_inp").value === code) {
            alert("Valid Captcha")
        } else {
            alert("Invalid Captcha. try Again");
            createCaptcha();
        }
    }


</script>
<script>

    $(document).ready(function () {
        //load captcha ro dorost kon
        //jae onsubmit captcha ro bayad avaz knam
        createCaptcha();
        // $("#signUp_email_auth_form_submit_btn").click(function () {
        //     $("#signUp_confirm_email_model").modal({backdrop: "static"});
        // });
        ///debuger ra dorost lon

    });

    $(document).ready(function () {
        //session ro bayad dorost konam
        // if (typeof (Storage) !== "undefined") {
        //     // Store
        //     sessionStorage.setItem("lastname", "saba");
        //     // Retrieve
        //     // alert(sessionStorage.getItem("lastname"));
        // } else {
        //     alert("Sorry, your browser does not support Web Storage...");
        // }


        $("#signUp_email_auth_form").submit(function (e) {
            e.preventDefault();

            //shart captcha ro dorost kon
            //bad az zadan beravad modal


            const signUp_email_auth_form_var = document.getElementById("signUp_email_auth_form");
            const email_var = signUp_email_auth_form_var.email.value;
            const password_var = signUp_email_auth_form_var.password.value;

            if (password_var.length >= 5) {
                const signUp_obj = {
                    email: email_var,
                    password: password_var
                };
                const signUp_json = JSON.stringify(signUp_obj);

                $.post("address.txt", function (data) {
                    const my_address = data + "signup-salesman/email-auth/";

                    $.ajax({
                        type: 'POST',
                        dataType: 'json',
                        contentType: 'application/json',
                        url: my_address,
                        data: signUp_json,
                        success: function (resultData, status, xhr) {
                            alert(resultData.message);
                            if (resultData.result.toString() === "true") {
                                $("#signUp_confirm_email_model").modal({backdrop: "static"});

                                $("#signUp_resend_code").click(function () {
                                    const signUp_resend_code_obj = {
                                        email: email_var,
                                    };
                                    const signUp_resend_code_json = JSON.stringify(signUp_resend_code_obj);
                                    const first_address = data + "signup-salesman/resend-code/";
                                    $.ajax({
                                        type: 'POST',
                                        dataType: 'json',
                                        contentType: 'application/json',
                                        url: first_address,
                                        data: signUp_resend_code_json,
                                        success: function (resultData, status, xhr) {
                                            alert(resultData.message);
                                            if (resultData.result.toString() === "true") {
                                                alert("change");
                                            }
                                        },
                                        error: function () {
                                            alert(" اتصال به اینترنت برقرار نیست. ");
                                        }
                                    })
                                });

                                $("#signUp_confirm_email_model_btn").click(function () {
                                    const code_var = document.getElementById("signUp_confirm_email_model_inp").value;

                                    const signUp_confirm_email_obj = {
                                        email: email_var,
                                        code: code_var
                                    };
                                    const signUp_confirm_email_json = JSON.stringify(signUp_confirm_email_obj);
                                    const second_address = data + "signup-salesman/confirm-email/";
                                    $.ajax({
                                        type: 'POST',
                                        dataType: 'json',
                                        contentType: 'application/json',
                                        url: second_address,
                                        data: signUp_confirm_email_json,
                                        success: function (resultData, status, xhr) {
                                            alert(resultData.message);
                                            if (resultData.result.toString() === "true") {
                                                window.sessionStorage.setItem("email", email_var);
                                                alert(window.sessionStorage.email);
                                                window.location.href="editprofile.html";
                                            }
                                        },
                                        error: function () {
                                            alert(" اتصال به اینترنت برقرار نیست. ");
                                        }
                                    })

                                });

                            }
                        },
                        error: function () {
                            alert(" اتصال به اینترنت برقرار نیست. ");
                        }
                    })

                });
            } else
                alert(" رمزعبور باید حداقل 5 کاراکتر باشد. ");
        });


        $("#login_form").submit(function (e) {
            e.preventDefault();

            const login_form_var = document.getElementById("login_form");
            const username_var = login_form_var.username.value;
            const password_var = login_form_var.password.value;


            if (username_var.length >= 5 && password_var.length >= 5) {
                const login_obj = {
                    username: username_var,
                    password: password_var
                };
                const login_json = JSON.stringify(login_obj);

                $.post("address.txt", function (data) {
                    const my_address = data + "login-salesman/";

                    $.ajax({
                        type: 'POST',
                        dataType: 'json',
                        contentType: 'application/json',
                        url: my_address,
                        data: login_json,
                        success: function(result, status, xhr){
                            alert(result.message);},
                        error: function () {
                            alert(" اتصال به اینترنت برقرار نیست. ");}
                    })

                });
            } else
                alert("طول نام کاربری و رمزعبور باید حداقل 5 کاراکتر باشد.");
        });


    });

</script>

</body>
</html>